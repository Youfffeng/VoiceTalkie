# Whisper æ¨¡å‹æœ¬åœ°é›†æˆæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—è¯´æ˜å¦‚ä½•å°† Whisper CoreML æ¨¡å‹æ–‡ä»¶æ‰“åŒ…åˆ° VoiceTalkie é¡¹ç›®ä¸­ï¼Œå®ç°ç¦»çº¿ä½¿ç”¨ï¼Œé¿å…æ¯æ¬¡å¯åŠ¨éƒ½éœ€è¦ä¸‹è½½æ¨¡å‹ã€‚

---

## ğŸ¯ å®ç°åŸç†

åº”ç”¨ç°åœ¨ä¼šæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§æŸ¥æ‰¾æ¨¡å‹ï¼š

1. **Application Support** ç›®å½•ï¼ˆç”¨æˆ·ç¼“å­˜ï¼‰
2. **App Bundle** å†…ç½®èµ„æºï¼ˆé¢„æ‰“åŒ…ï¼‰
3. **ç½‘ç»œä¸‹è½½**ï¼ˆä½œä¸ºå¤‡é€‰ï¼‰

---

## ğŸ“¥ æ­¥éª¤ 1ï¼šä¸‹è½½æ¨¡å‹æ–‡ä»¶

### æ–¹æ³• Aï¼šä½¿ç”¨å‘½ä»¤è¡Œä¸‹è½½ï¼ˆæ¨èï¼‰

```bash
# 1. å®‰è£… git-lfs
brew install git-lfs
git lfs install

# 2. å…‹éš† WhisperKit æ¨¡å‹ä»“åº“
cd ~/Downloads
git clone https://huggingface.co/argmaxinc/whisperkit-coreml

# 3. æ‰¾åˆ°æ¨¡å‹æ–‡ä»¶å¤¹
cd whisperkit-coreml
ls -la | grep openai_whisper
```

### æ–¹æ³• Bï¼šä» HuggingFace ç›´æ¥ä¸‹è½½

è®¿é—®ï¼šhttps://huggingface.co/argmaxinc/whisperkit-coreml

é€‰æ‹©éœ€è¦çš„æ¨¡å‹ï¼ˆæ¨è `openai_whisper-small`ï¼‰ï¼Œä¸‹è½½æ•´ä¸ªæ–‡ä»¶å¤¹ã€‚

---

## ğŸ—‚ï¸ æ­¥éª¤ 2ï¼šå‡†å¤‡æ¨¡å‹æ–‡ä»¶

### æ¨¡å‹æ–‡ä»¶å¤¹ç»“æ„

ä¸‹è½½åçš„æ¨¡å‹æ–‡ä»¶å¤¹åº”è¯¥ç±»ä¼¼è¿™æ ·ï¼š

```
openai_whisper-small/
â”œâ”€â”€ AudioEncoder.mlmodelc/
â”œâ”€â”€ TextDecoder.mlmodelc/
â”œâ”€â”€ MelSpectrogram.mlmodelc/
â”œâ”€â”€ config.json
â”œâ”€â”€ merges.txt
â””â”€â”€ vocab.json
```

### æ¨èçš„æ¨¡å‹

| æ¨¡å‹ | å¤§å° | é€Ÿåº¦ | ç²¾åº¦ | æ¨èåœºæ™¯ |
|------|------|------|------|----------|
| `tiny` | ~75MB | æœ€å¿« | è¾ƒä½ | æµ‹è¯•/å¿«é€ŸåŸå‹ |
| `base` | ~145MB | å¿« | ä¸­ç­‰ | æ—¥å¸¸ä½¿ç”¨ |
| `small` | ~245MB | é€‚ä¸­ | è¾ƒé«˜ | **æ¨è** - å¹³è¡¡æ€§èƒ½å’Œç²¾åº¦ |
| `medium` | ~769MB | æ…¢ | é«˜ | é«˜ç²¾åº¦éœ€æ±‚ |
| `large-v3` | ~1.5GB | å¾ˆæ…¢ | æœ€é«˜ | ä¸“ä¸šç”¨é€” |

---

## ğŸ“¦ æ­¥éª¤ 3ï¼šæ·»åŠ åˆ° Xcode é¡¹ç›®

### 3.1 åˆ›å»º Models èµ„æºæ–‡ä»¶å¤¹

1. åœ¨ Xcode ä¸­ï¼Œå³é”®ç‚¹å‡» `VoiceTalkie` é¡¹ç›®
2. é€‰æ‹© `New Group`
3. å‘½åä¸º `Models`

### 3.2 æ·»åŠ æ¨¡å‹æ–‡ä»¶

1. å°†ä¸‹è½½çš„æ¨¡å‹æ–‡ä»¶å¤¹æ‹–æ‹½åˆ° `Models` ç»„ä¸­
2. åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œç¡®ä¿å‹¾é€‰ï¼š
   - âœ… **Copy items if needed**
   - âœ… **Create folder references** ï¼ˆé‡è¦ï¼ï¼‰
   - âœ… Target: `VoiceTalkie`

**âš ï¸ æ³¨æ„**ï¼šå¿…é¡»é€‰æ‹© **Create folder references**ï¼ˆè“è‰²æ–‡ä»¶å¤¹å›¾æ ‡ï¼‰ï¼Œè€Œä¸æ˜¯ **Create groups**ã€‚

### 3.3 éªŒè¯æ·»åŠ æˆåŠŸ

åœ¨ Xcode é¡¹ç›®å¯¼èˆªå™¨ä¸­ï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š

```
VoiceTalkie/
â”œâ”€â”€ Models/  ï¼ˆè“è‰²æ–‡ä»¶å¤¹ï¼‰
â”‚   â””â”€â”€ openai_whisper-small/  ï¼ˆè“è‰²æ–‡ä»¶å¤¹ï¼‰
â”‚       â”œâ”€â”€ AudioEncoder.mlmodelc/
â”‚       â”œâ”€â”€ TextDecoder.mlmodelc/
â”‚       â””â”€â”€ ...
```

### 3.4 æ£€æŸ¥ Build Phases

1. é€‰æ‹©é¡¹ç›® â†’ Target: VoiceTalkie
2. åˆ‡æ¢åˆ° **Build Phases** æ ‡ç­¾
3. å±•å¼€ **Copy Bundle Resources**
4. ç¡®è®¤æ¨¡å‹æ–‡ä»¶å¤¹åœ¨åˆ—è¡¨ä¸­

---

## âœ… æ­¥éª¤ 4ï¼šéªŒè¯é›†æˆ

### 4.1 ç¼–è¯‘é¡¹ç›®

```bash
cd /Users/youfeng/voicetalkie/VoiceTalkie
xcodebuild -project VoiceTalkie.xcodeproj -scheme VoiceTalkie clean build
```

### 4.2 æ£€æŸ¥ Bundle å†…å®¹

```bash
# ç¼–è¯‘åï¼Œæ£€æŸ¥åº”ç”¨åŒ…å†…å®¹
BUNDLE_PATH=$(find ~/Library/Developer/Xcode/DerivedData -name "VoiceTalkie.app" -type d | head -1)
ls -la "$BUNDLE_PATH/Contents/Resources/" | grep whisper
```

åº”è¯¥èƒ½çœ‹åˆ°æ¨¡å‹æ–‡ä»¶å¤¹ã€‚

### 4.3 è¿è¡Œåº”ç”¨æµ‹è¯•

1. è¿è¡Œ VoiceTalkie
2. æ‰“å¼€è®¾ç½®ç•Œé¢
3. æŸ¥çœ‹æ¨¡å‹é€‰æ‹©å™¨ä¸­ï¼Œ`small` æ¨¡å‹åº”è¯¥æ˜¾ç¤º **âœ… æœ¬åœ°** æ ‡è®°
4. æ§åˆ¶å°æ—¥å¿—åº”è¯¥æ˜¾ç¤ºï¼š

```
ğŸ“¦ [WhisperManager] æ‰¾åˆ°Bundleä¸­çš„æ¨¡å‹
âœ… [WhisperManager] å·²å¤åˆ¶æ¨¡å‹åˆ°æœ¬åœ°
âœ… [WhisperManager] ä½¿ç”¨æœ¬åœ°æ¨¡å‹åˆå§‹åŒ–æˆåŠŸ: small
```

---

## ğŸ”§ é«˜çº§é…ç½®

### æ”¯æŒå¤šä¸ªæ¨¡å‹

é‡å¤æ­¥éª¤ 3.2ï¼Œæ·»åŠ æ›´å¤šæ¨¡å‹æ–‡ä»¶å¤¹ï¼š

```
Models/
â”œâ”€â”€ openai_whisper-tiny/
â”œâ”€â”€ openai_whisper-base/
â”œâ”€â”€ openai_whisper-small/
â””â”€â”€ openai_whisper-medium/
```

### å‡å°åº”ç”¨ä½“ç§¯

å¦‚æœåªéœ€è¦ä¸€ä¸ªæ¨¡å‹ï¼Œåªæ·»åŠ è¯¥æ¨¡å‹æ–‡ä»¶å¤¹å³å¯ã€‚æ¨èï¼š
- **å¼€å‘/æµ‹è¯•**ï¼š`tiny` (~75MB)
- **ç”Ÿäº§ç¯å¢ƒ**ï¼š`small` (~245MB)

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜ 1ï¼šæ¨¡å‹æœªè¢«è¯†åˆ«

**ç—‡çŠ¶**ï¼šè®¾ç½®ä¸­ä»æ˜¾ç¤º"éœ€ä¸‹è½½"

**è§£å†³**ï¼š
1. æ£€æŸ¥æ–‡ä»¶å¤¹åç§°å¿…é¡»æ˜¯ `openai_whisper-{model_name}`
2. ç¡®è®¤ä½¿ç”¨ **folder references**ï¼ˆè“è‰²æ–‡ä»¶å¤¹ï¼‰
3. æ£€æŸ¥ Build Phases â†’ Copy Bundle Resources

### é—®é¢˜ 2ï¼šåº”ç”¨ä½“ç§¯è¿‡å¤§

**ç—‡çŠ¶**ï¼šåº”ç”¨åŒ…è¶…è¿‡ 500MB

**è§£å†³**ï¼š
- åªæ‰“åŒ…æœ€å¸¸ç”¨çš„æ¨¡å‹ï¼ˆå¦‚ `small`ï¼‰
- å…¶ä»–æ¨¡å‹è®©ç”¨æˆ·æ ¹æ®éœ€è¦ä¸‹è½½
- è€ƒè™‘ä½¿ç”¨ On-Demand Resourcesï¼ˆODRï¼‰

### é—®é¢˜ 3ï¼šæ¨¡å‹åŠ è½½å¤±è´¥

**ç—‡çŠ¶**ï¼šæ—¥å¿—æ˜¾ç¤º "Resource path does not exist"

**è§£å†³**ï¼š
1. æ£€æŸ¥æ¨¡å‹æ–‡ä»¶å¤¹å®Œæ•´æ€§
2. ç¡®è®¤ `.mlmodelc` æ–‡ä»¶å¤¹å­˜åœ¨
3. æ£€æŸ¥ `config.json` æ˜¯å¦å­˜åœ¨

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### é¦–æ¬¡å¯åŠ¨æ—¶é—´

| åœºæ™¯ | æ—¶é—´ | è¯´æ˜ |
|------|------|------|
| ç½‘ç»œä¸‹è½½ small æ¨¡å‹ | ~30-60ç§’ | å–å†³äºç½‘é€Ÿ |
| ä½¿ç”¨ Bundle æ¨¡å‹ | ~2-3ç§’ | ä»…å¤åˆ¶åˆ°ç¼“å­˜ |
| ä½¿ç”¨ç¼“å­˜æ¨¡å‹ | <1ç§’ | ç›´æ¥åŠ è½½ |

### å­˜å‚¨ç©ºé—´

- **Bundle æ¨¡å‹**ï¼šå ç”¨åº”ç”¨å®‰è£…ä½“ç§¯
- **ç¼“å­˜æ¨¡å‹**ï¼šå ç”¨ç”¨æˆ·æ•°æ®ç©ºé—´ï¼ˆå¯æ¸…ç†ï¼‰

---

## ğŸ¯ æ¨èé…ç½®

### æ–¹æ¡ˆ Aï¼šæœ€ä½³ç”¨æˆ·ä½“éªŒï¼ˆæ¨èï¼‰

**å†…ç½®æ¨¡å‹**ï¼š`small` (~245MB)  
**ä¼˜ç‚¹**ï¼šé¦–æ¬¡ä½¿ç”¨å³å¯ç¦»çº¿å·¥ä½œ  
**ç¼ºç‚¹**ï¼šåº”ç”¨ä½“ç§¯è¾ƒå¤§

### æ–¹æ¡ˆ Bï¼šå¹³è¡¡æ–¹æ¡ˆ

**å†…ç½®æ¨¡å‹**ï¼š`tiny` (~75MB)  
**ä¼˜ç‚¹**ï¼šåº”ç”¨ä½“ç§¯å°ï¼Œå¿«é€Ÿå¯åŠ¨  
**ç¼ºç‚¹**ï¼šéœ€è¦ç”¨æˆ·æ‰‹åŠ¨ä¸‹è½½é«˜ç²¾åº¦æ¨¡å‹

### æ–¹æ¡ˆ Cï¼šå®Œå…¨ç½‘ç»œä¸‹è½½

**å†…ç½®æ¨¡å‹**ï¼šæ—   
**ä¼˜ç‚¹**ï¼šåº”ç”¨ä½“ç§¯æœ€å°  
**ç¼ºç‚¹**ï¼šé¦–æ¬¡ä½¿ç”¨éœ€è¦ç½‘ç»œ

---

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

1. **å¢é‡ä¸‹è½½**ï¼šæ”¯æŒæ–­ç‚¹ç»­ä¼ 
2. **æ¨¡å‹å…±äº«**ï¼šå¤šåº”ç”¨å…±äº«æ¨¡å‹ç¼“å­˜
3. **è‡ªåŠ¨æ¸…ç†**ï¼šæ¸…ç†æœªä½¿ç”¨çš„æ—§æ¨¡å‹
4. **å‹ç¼©ä¼ è¾“**ï¼šä¼˜åŒ–ç½‘ç»œä¸‹è½½å¤§å°

---

**åˆ›å»ºæ—¶é—´**: 2025-11-18  
**é€‚ç”¨ç‰ˆæœ¬**: VoiceTalkie 1.0+  
**æœ€åæ›´æ–°**: 2025-11-18
